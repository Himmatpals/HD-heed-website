<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>HD HeeD ‚Äì Outreach & Follow-up Dashboard</title>
  <meta name="description" content="HD HeeD outreach emails and NDIS weekly follow-up board for Support Coordinators & Plan Managers." />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    :root {
      /* Light theme (default, from File 1) */
      --brand: #6b46ff;
      --brand-dark: #4f27ff;
      --ink: #0f172a;
      --ink-2: #334155;
      --muted: #64748b;
      --bg: #f8fafc;
      --card: #ffffff;
      --ring: rgba(107, 70, 255, .35);
      --radius: 16px;
      --shadow: 0 10px 30px rgba(15, 23, 42, .08);
      --alert-red: #ff3333;
      /* Board-specific (from File 2, adapted) */
      --board-bg: #0b0f1a;
      --board-panel: #10172a;
      --board-line: #243153;
      --board-text: #e8edff;
      --board-muted: #a8b6e8;
      --board-accent: #ffc107;
      --board-good: #31d0aa;
      --board-warn: #ffd95c;
      --board-danger: #ff5d5d;
    }
    /* Dark theme */
    [data-theme="dark"] {
      --brand: #9b8cff;
      --brand-dark: #6b46ff;
      --ink: #e8edff;
      --ink-2: #cfe0ff;
      --muted: #a8b6e8;
      --bg: #0b0f1a;
      --card: #10172a;
      --ring: rgba(174, 230, 255, .35);
      --shadow: 0 28px 110px rgba(0, 0, 0, .55);
      --alert-red: #ff5d5d;
    }
    * { box-sizing: border-box; }
    html, body { margin: 0; padding: 0; font-family: Inter, system-ui, Arial, sans-serif; height: 100%; }
    body { background: var(--bg); color: var(--ink); transition: background 0.3s, color 0.3s; }
    .nav-bar {
      position: sticky; top: 0; z-index: 10; background: var(--card); border-bottom: 1px solid var(--board-line, #eef2ff);
      padding: 12px 20px; display: flex; gap: 16px; align-items: center; box-shadow: var(--shadow);
    }
    .nav-bar .logo {
      width: 48px; height: 48px; border-radius: 12px;
      background: radial-gradient(120% 120% at 30% 30%, #9b8cff 0%, var(--brand) 42%, var(--brand-dark) 100%);
      box-shadow: 0 8px 20px var(--ring);
    }
    .nav-bar a {
      font-weight: 700; color: var(--ink-2); text-decoration: none; padding: 8px 12px; border-radius: 8px;
      transition: background 0.2s, color 0.2s;
    }
    .nav-bar a.active { background: var(--brand); color: #fff; }
    .nav-bar a:hover { background: var(--ring); }
    .theme-toggle {
      margin-left: auto; background: none; border: none; font-size: 16px; cursor: pointer; color: var(--ink-2);
    }
    .container { max-width: 1200px; margin: 24px auto; padding: 0 20px; }
    /* Email Section Styles (from File 1) */
    .email-section { display: none; }
    .email-section.active { display: block; }
    .email-section .wrap { max-width: 1100px; margin: 48px auto; padding: 0 20px; }
    .email-section .hero { display: flex; align-items: center; gap: 18px; margin-bottom: 24px; }
    .email-section .logo {
      width: 56px; height: 56px; border-radius: 14px;
      background: radial-gradient(120% 120% at 30% 30%, #9b8cff 0%, var(--brand) 42%, var(--brand-dark) 100%);
      box-shadow: 0 10px 25px var(--ring), inset 0 0 18px rgba(255, 255, 255, .36);
    }
    .email-section h1 { margin: 0; font-weight: 800; letter-spacing: -.02em; font-size: clamp(22px, 3.4vw, 34px); }
    .email-section .sub { margin-top: 6px; color: var(--muted); font-size: 14px; }
    .email-section .bar { display: flex; flex-wrap: wrap; gap: 10px; margin: 16px 0 26px; }
    .email-section .badge {
      font-size: 12px; color: #fff; background: var(--brand); padding: 8px 12px;
      border-radius: 999px; font-weight: 600; letter-spacing: .02em;
    }
    .email-section .card {
      background: var(--card); border-radius: var(--radius); box-shadow: var(--shadow);
      padding: 22px; margin-bottom: 22px; border: 1px solid var(--board-line, #eef2ff);
    }
    .email-section .eyebrow {
      font-size: 12px; letter-spacing: .16em; text-transform: uppercase; color: var(--muted);
      font-weight: 700; margin-bottom: 4px;
    }
    .email-section .title {
      margin: 0 0 14px 0; font-size: 20px; font-weight: 800; letter-spacing: -.01em;
    }
    .email-section label {
      display: block; font-size: 12px; font-weight: 700; color: var(--ink-2); margin: 10px 0 6px;
    }
    .email-section input[type="text"], .email-section textarea {
      width: 100%; border: 1.5px solid var(--board-line, #e5e7eb); border-radius: 12px;
      background: var(--card); color: var(--ink); padding: 12px 14px; font: inherit;
      box-shadow: inset 0 1px 0 rgba(0, 0, 0, .02);
    }
    .email-section input[type="text"]:focus, .email-section textarea:focus {
      outline: 0; border-color: var(--brand); box-shadow: 0 0 0 4px var(--ring);
    }
    .email-section textarea { min-height: 220px; line-height: 1.5; white-space: pre-wrap; }
    .email-section .actions { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 12px; }
    .email-section .btn {
      appearance: none; border: 0; background: var(--ink); color: #fff; padding: 10px 12px;
      border-radius: 12px; font-weight: 700; cursor: pointer; transition: transform 0.2s;
    }
    .email-section .btn.secondary { background: var(--board-line, #eef2ff); color: #3b3b63; }
    .email-section .btn.brand { background: var(--brand); }
    .email-section .btn:active { transform: translateY(1px); }
    .email-section .note { font-size: 12px; color: var(--muted); margin-top: 10px; }
    .email-section .footer { margin: 28px 0 36px; color: var(--muted); font-size: 12px; }
    .email-section .paper-referral-alert {
      background: #fff5f5; border: 2px solid var(--alert-red); border-radius: var(--radius);
      padding: 16px 20px; margin: 0 0 26px 0; text-align: center; box-shadow: 0 4px 12px rgba(255, 51, 51, 0.2);
      animation: pulse 2s infinite;
    }
    .email-section .paper-referral-alert h3 {
      color: var(--alert-red); margin: 0 0 8px 0; font-weight: 800; font-size: 18px;
    }
    .email-section .paper-referral-alert p { margin: 0 0 12px 0; color: var(--ink-2); }
    .email-section .paper-referral-link {
      display: inline-block; background: var(--alert-red); color: white !important; padding: 12px 24px;
      border-radius: 10px; font-weight: 700; text-decoration: none; box-shadow: 0 4px 6px rgba(255, 51, 51, 0.3);
      transition: all 0.2s ease;
    }
    .email-section .paper-referral-link:hover {
      background: #ff1a1a; transform: translateY(-2px); box-shadow: 0 6px 12px rgba(255, 51, 51, 0.4);
    }
    .email-section .paper-referral-link:active { transform: translateY(0); }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(255, 51, 51, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(255, 51, 51, 0); }
      100% { box-shadow: 0 0 0 0 rgba(255, 51, 51, 0); }
    }
    /* Board Section Styles (from File 2) */
    .board-section { display: none; }
    .board-section.active { display: block; }
    .board-section .shell {
      max-width: 1200px; margin: 0 auto; background: var(--card); border: 1px solid var(--board-line);
      border-radius: 18px; box-shadow: var(--shadow); overflow: hidden;
    }
    .board-section .head {
      display: flex; align-items: center; gap: 12px; padding: 16px 18px; border-bottom: 1px solid var(--board-line);
      background: var(--card); position: sticky; top: 0; z-index: 2;
    }
    .board-section .badge {
      width: 42px; height: 42px; border-radius: 10px; display: grid; place-items: center;
      font-weight: 900; color: #2a2100; background: linear-gradient(135deg, var(--board-warn), #ffe78f);
      box-shadow: 0 8px 24px var(--shadow);
    }
    .board-section .title { font-weight: 900; font-size: 1.15rem; letter-spacing: .2px; }
    .board-section .sub { font-size: .88rem; color: var(--muted); }
    .board-section .toolbar { margin-left: auto; display: flex; gap: 8px; align-items: center; flex-wrap: wrap; }
    .board-section .pill {
      border: 1px solid var(--board-line); background: var(--board-panel); border-radius: 999px;
      padding: 6px 10px; font-size: .78rem; color: var(--board-text);
    }
    .board-section .btn {
      border: 1px solid var(--board-line); background: var(--board-panel); color: var(--board-text);
      border-radius: 12px; padding: 10px 14px; font-weight: 800; cursor: pointer; transition: transform 0.2s;
    }
    .board-section .btn.primary {
      background: var(--board-accent); color: #2a2100; border-color: #e0b200; box-shadow: var(--shadow);
    }
    .board-section .btn.warn { background: #351616; border-color: #6e1c1c; color: #ffdcdc; }
    .board-section .btn.ghost { background: var(--board-panel); }
    .board-section .btn:disabled { opacity: .55; cursor: not-allowed; }
    .board-section .status { font-size: .8rem; color: var(--muted); }
    .board-section .wrap { padding: 16px; }
    .board-section .board {
      border: 1px solid var(--board-line); background: var(--board-panel); border-radius: 16px; overflow: auto;
    }
    .board-section table { border-collapse: separate; border-spacing: 0; width: 100%; min-width: 1100px; }
    .board-section th, .board-section td {
      border-bottom: 1px solid var(--board-line); border-right: 1px solid var(--board-line); padding: 10px; vertical-align: top;
    }
    .board-section th:first-child, .board-section td:first-child { border-left: 1px solid var(--board-line); }
    .board-section thead th {
      position: sticky; top: 0; background: var(--board-panel); color: var(--board-text); font-weight: 900; font-size: .96rem; z-index: 1;
    }
    .board-section tbody th {
      background: var(--board-panel); text-align: left; font-weight: 800; white-space: nowrap; min-width: 380px;
    }
    .board-section .lead { display: flex; flex-direction: column; gap: 6px; }
    .board-section .lead .name { font-weight: 900; color: var(--board-warn); }
    .board-section .lead .meta { display: flex; gap: 12px; flex-wrap: wrap; font-size: .85rem; color: var(--board-text); }
    .board-section .lead .meta a {
      color: #aee6ff; text-decoration: none; border-bottom: 1px dotted rgba(174, 230, 255, .35); padding-bottom: 1px;
    }
    .board-section .lead .meta a:hover { color: var(--board-text); border-bottom-color: var(--board-text); }
    .board-section .cell {
      background: var(--board-panel); border: 1px solid var(--board-line); border-radius: 10px; padding: 8px;
      min-height: 48px; display: flex; align-items: center; justify-content: space-between; gap: 8px; cursor: pointer;
    }
    .board-section .cell .preview {
      flex: 1; max-width: 100%; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; color: var(--board-text); opacity: .95;
    }
    .board-section .cell .badge {
      font-size: 12px; border: 1px solid var(--board-line); background: var(--board-panel); color: var(--board-text);
      border-radius: 999px; padding: 4px 8px;
    }
    .board-section .cell.empty .badge { opacity: .6; }
    .board-section .cell.empty .preview { color: var(--board-muted); opacity: .7; }
    .board-section .cell:hover { box-shadow: 0 0 0 2px rgba(255, 209, 64, .25); }
    .board-section .modal-backdrop {
      position: fixed; inset: 0; background: rgba(2, 6, 22, .58); backdrop-filter: blur(2px);
      display: none; align-items: center; justify-content: center; z-index: 1000;
    }
    .board-section .modal {
      width: min(900px, 94vw); max-height: 85vh; background: var(--card); border: 1px solid var(--board-line);
      border-radius: 16px; box-shadow: var(--shadow); display: flex; flex-direction: column;
    }
    .board-section .modal-head { display: flex; gap: 10px; align-items: center; padding: 12px 14px; border-bottom: 1px solid var(--board-line); }
    .board-section .modal-title { font-weight: 900; }
    .board-section .modal-close {
      margin-left: auto; border: 1px solid var(--board-line); background: var(--board-panel); color: var(--board-text);
      border-radius: 999px; padding: 6px 10px; cursor: pointer;
    }
    .board-section .modal-body { padding: 12px 14px; }
    .board-section .modal-body textarea {
      width: 100%; min-height: 44vh; border: 1px solid var(--board-line); border-radius: 10px; padding: 10px;
      background: var(--board-panel); color: var(--board-text); resize: vertical; font-family: inherit; font-size: 1rem;
    }
    .board-section .modal-foot { padding: 12px 14px; border-top: 1px dashed var(--board-line); display: flex; gap: 8px; justify-content: flex-end; }
    .board-section .kbd {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; font-size: .82rem;
      padding: 2px 6px; border: 1px solid var(--board-line); border-radius: 6px; background: var(--board-panel); color: var(--board-text);
    }
    .board-section .foot { border-top: 1px dashed var(--board-line); padding: 12px 18px; display: flex; gap: 10px; align-items: center; justify-content: space-between; }
    .board-section .cleaner { margin-left: auto; display: flex; gap: 8px; align-items: center; }
    @media (max-width: 920px) {
      .email-section .grid { grid-template-columns: 1fr; }
      .board-section table { min-width: 800px; }
    }
    @media (max-width: 820px) {
      .board-section .title { font-size: 1rem; }
      .board-section tbody th { min-width: 300px; }
    }
    @media print { .nav-bar, .board-section .toolbar, .board-section .foot, .board-section .modal-backdrop { display: none !important; } }
  </style>
</head>
<body>
  <!-- Navigation Bar -->
  <nav class="nav-bar">
    <div class="logo" aria-hidden="true"></div>
    <a href="#emails" class="nav-link active" data-section="email-section">Outreach Emails</a>
    <a href="#board" class="nav-link" data-section="board-section">Follow-up Board</a>
    <button class="theme-toggle" aria-label="Toggle theme">üåô</button>
  </nav>

  <!-- Email Section (from File 1) -->
  <section class="email-section active">
    <div class="wrap">
      <div class="hero">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>HD HeeD ‚Äì Outreach Emails (1‚Äì4)</h1>
          <div class="sub">Copy-ready subjects and bodies for Support Coordinators & Plan Managers.
            <span class="small">Use the buttons to copy Subject, Body, or Both.</span>
          </div>
        </div>
      </div>

      <div class="bar">
        <span class="badge">RN‚ÄëLed Provider</span>
        <span class="badge">Online Referrals</span>
        <span class="badge">AILR Onboarding</span>
        <span class="badge">Audit‚ÄëReady</span>
      </div>

      <div class="paper-referral-alert">
        <h3>üìÑ Paper-Based Referral Form Available</h3>
        <p>Prefer to use a paper form? Download our printable referral form and email the completed copy to info@hdheed.com.au</p>
        <a href="https://drive.google.com/file/d/1Z3EJ2mycLwNAIDXs2fnIfD8H_wxcSdQx/view?usp=drive_link" class="paper-referral-link" target="_blank">
          Download Paper Referral Form
        </a>
      </div>

      <div class="card">
        <div class="eyebrow">Bulk tool</div>
        <h2 class="title">Copy All Emails</h2>
        <div class="actions">
          <button class="btn brand" onclick="copyAll()">Copy All (Subjects + Bodies)</button>
        </div>
        <div class="note">This will copy Emails 1‚Äì4 in order with clear separators.</div>
      </div>

      <section class="card" id="e1">
        <div class="eyebrow">Email 1</div>
        <h3 class="title">Introduction to HD HeeD</h3>
        <label for="s1">Subject</label>
        <input id="s1" type="text" value="Introducing HD HeeD ‚Äì RN-Led NDIS Provider in Blacktown" />
        <label for="b1">Body</label>
        <textarea id="b1">Hi,

Please let me introduce HD HeeD Pty Ltd, an NDIS-registered provider based in Blacktown. We are an RN-led team, with the skills and systems to deliver safe, professional, and person-centred supports.

We are registered under the following NDIS groups:
‚Ä¢ 0104 ‚Äì High Intensity Daily Personal Activities
‚Ä¢ 0107 ‚Äì Daily Personal Activities
‚Ä¢ 0115 ‚Äì Assistance with Daily Life Tasks in a Group/Shared Living
‚Ä¢ 0117 ‚Äì Development of Daily Living and Life Skills
‚Ä¢ 0120 ‚Äì Household Tasks
‚Ä¢ 0125 ‚Äì Participation in Community, Social and Civic Activities
‚Ä¢ 0136 ‚Äì Group and Centre-Based Activities

At HD HeeD, we keep onboarding simple and organised:
‚Ä¢ Visit our website: https://www.hdheed.com.au
‚Ä¢ Talk directly to our AI assistant Ella
‚Ä¢ Submit a referral using our online referral form or quick referral link: https://www.hdheed.com.au/referral.html
‚Ä¢ Or simply reply to this email / email us at info@hdheed.com.au or ndis@hdheed.com.au

We are here to support you and your participants with a streamlined process, strong clinical expertise, and a person-centred approach.

üëâ Start a referral today: https://www.hdheed.com.au/referral.html

Kind regards,
Mat Syan
Director ‚Äì HD HeeD Pty Ltd
üìû 02 8630 5500 | ‚úâÔ∏è info@hdheed.com.au</textarea>
        <div class="actions">
          <button class="btn brand" onclick="copySubject('s1')">Copy Subject</button>
          <button class="btn" onclick="copyBody('b1')">Copy Body</button>
          <button class="btn secondary" onclick="copyBoth('s1','b1')">Copy Both</button>
        </div>
      </section>

      <section class="card" id="e2">
        <div class="eyebrow">Email 2</div>
        <h3 class="title">Our RN-Led Strength</h3>
        <label for="s2">Subject</label>
        <input id="s2" type="text" value="Nursing Expertise at the Core of HD HeeD" />
        <label for="b2">Body</label>
        <textarea id="b2">Hi,

At HD HeeD, we are proud to be a group of Registered Nurses who are extremely confident in our skills and experience. This allows us to provide participants with the highest standard of care, especially when it comes to complex health needs.

We deliver this care under registration group 0104 ‚Äì High Intensity Daily Personal Activities. This makes our services not only clinically safe and professional, but also a practical and cost-effective option compared to group 0114 (Community Nursing), which is charged at a much higher rate.

By choosing HD HeeD, your participants receive the benefits of RN-level support within the right NDIS registration group, ensuring both quality and value.

üëâ Start a referral today: https://www.hdheed.com.au/referral.html

Please also find a paper-based referral form attached that you can complete manually and email back to us at info@hdheed.com.au, if that is your preferred method.

You are always welcome to call us directly on 02 8630 5500 to discuss referrals or participant needs further.

Kind regards,
Mat Syan
Director ‚Äì HD HeeD Pty Ltd
üìû 02 8630 5500 | ‚úâÔ∏è info@hdheed.com.au</textarea>
        <div class="actions">
          <button class="btn brand" onclick="copySubject('s2')">Copy Subject</button>
          <button class="btn" onclick="copyBody('b2')">Copy Body</button>
          <button class="btn secondary" onclick="copyBoth('s2','b2')">Copy Both</button>
        </div>
      </section>

      <section class="card" id="e3">
        <div class="eyebrow">Email 3</div>
        <h3 class="title">AILR System</h3>
        <label for="s3">Subject</label>
        <input id="s3" type="text" value="Meet AILR ‚Äì Advanced Intake & Long-form Registration" />
        <label for="b3">Body</label>
        <textarea id="b3">Hi,

One of our key strengths at HD HeeD is our AILR system ‚Äì Advanced Intake & Long-form Registration.

AILR ensures that most of the participant‚Äôs onboarding is completed online, with only a few signature forms returned manually or via email. This makes the process:
‚Ä¢ Systematic and organised
‚Ä¢ Less paperwork for you and your clients
‚Ä¢ Straightforward, convenient, and time-saving

If a participant needs help, we are more than happy to sit with them and complete the AILR together.

üëâ You can visit and view our online AILR system here: https://www.hdheed.com.au/ailr.html

When you‚Äôre ready to make a referral, you can use our quick online referral form here: https://www.hdheed.com.au/referral.html

For those who prefer, a paper-based referral form can also be emailed back to info@hdheed.com.au. And of course, you‚Äôre always welcome to call us directly on 02 8630 5500.

Kind regards,
Mat Syan
Director ‚Äì HD HeeD Pty Ltd
üìû 02 8630 5500 | ‚úâÔ∏è info@hdheed.com.au</textarea>
        <div class="actions">
          <button class="btn brand" onclick="copySubject('s3')">Copy Subject</button>
          <button class="btn" onclick="copyBody('b3')">Copy Body</button>
          <button class="btn secondary" onclick="copyBoth('s3','b3')">Copy Both</button>
        </div>
      </section>

      <section class="card" id="e4">
        <div class="eyebrow">Email 4</div>
        <h3 class="title">Easy Online Referrals</h3>
        <label for="s4">Subject</label>
        <input id="s4" type="text" value="Referrals Made Simple with HD HeeD" />
        <label for="b4">Body</label>
        <textarea id="b4">Hi,

At HD HeeD, we understand how valuable your time is. That‚Äôs why we‚Äôve created a quick and hassle-free online referral system to make things easier for you and your participants.

You can submit a referral in just a few minutes using our secure portal:
üëâ https://www.hdheed.com.au/referral.html

The system is streamlined, convenient, and fully audit-ready, ensuring participants are onboarded faster and without unnecessary delays.

Alternatively, we are also attaching a paper-based referral form. You can complete it, scan it, and email it back to us at info@hdheed.com.au if that is your preferred way of making a referral.

Whether you choose online or paper, we‚Äôll make sure the onboarding is handled quickly, professionally, and with minimal hassle.

Kind regards,
Mat Syan
Director ‚Äì HD HeeD Pty Ltd
üìû 02 8630 5500 | ‚úâÔ∏è info@hdheed.com.au</textarea>
        <div class="actions">
          <button class="btn brand" onclick="copySubject('s4')">Copy Subject</button>
          <button class="btn" onclick="copyBody('b4')">Copy Body</button>
          <button class="btn secondary" onclick="copyBoth('s4','b4')">Copy Both</button>
        </div>
      </section>

      <div class="footer">¬© HD HeeD Pty Ltd ‚Ä¢ ABN 47 665 228 768 ‚Ä¢ Blacktown, NSW ‚Ä¢ Phone: 02 8630 5500 ‚Ä¢ <a href="mailto:info@hdheed.com.au">info@hdheed.com.au</a></div>
    </div>
  </section>

  <!-- Board Section (from File 2) -->
  <section class="board-section">
    <div class="shell">
      <div class="head">
        <div class="badge">HD</div>
        <div>
          <div class="title">HD HeeD ‚Äî NDIS Weekly Follow-up Board</div>
          <div class="sub">Support Coordinators & Plan Managers ‚Ä¢ Blacktown & Western Sydney</div>
        </div>
        <div class="toolbar">
          <button id="btnRefresh" class="btn">üîÑ Refresh</button>
          <button id="btnSave" class="btn primary">üíæ Save changes</button>
          <span id="status" class="status"></span>
          <span class="pill">Shared ‚Ä¢ Live</span>
        </div>
      </div>

      <div class="wrap">
        <div class="board">
          <table id="board">
            <thead>
              <tr>
                <th style="width:380px">Lead (SC/PM)</th>
                <th>Monday</th><th>Tuesday</th><th>Wednesday</th>
                <th>Thursday</th><th>Friday</th><th>Saturday</th><th>Sunday</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
        <div class="hint">Click a day cell to open the full note. Press <span class="kbd">Esc</span> or click outside to close. Click <strong>Save changes</strong> to sync with the Sheet.</div>
      </div>

      <div class="foot">
        <div class="status" id="footStatus">Ready.</div>
        <div class="cleaner">
          <span class="status">Fresh week reset:</span>
          <button id="btnArmClean" class="btn ghost">1) Arm</button>
          <button id="btnDoClean" class="btn warn" disabled>2) Confirm &amp; wipe</button>
        </div>
      </div>
    </div>

    <div id="modalBackdrop" class="modal-backdrop" aria-hidden="true">
      <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
        <div class="modal-head">
          <div id="modalTitle" class="modal-title">Edit note</div>
          <button id="modalClose" class="modal-close">‚úï Close</button>
        </div>
        <div class="modal-body">
          <textarea id="modalTextarea" placeholder="Type your note‚Ä¶"></textarea>
        </div>
        <div class="modal-foot">
          <button id="modalSave" class="btn primary">üíæ Apply to cell</button>
        </div>
      </div>
    </div>
  </section>

  <script>
    // Theme Toggle
    const themeToggle = document.querySelector('.theme-toggle');
    themeToggle.addEventListener('click', () => {
      const currentTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
      document.documentElement.setAttribute('data-theme', currentTheme);
      themeToggle.textContent = currentTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
      localStorage.setItem('theme', currentTheme);
    });
    // Load saved theme
    const savedTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', savedTheme);
    themeToggle.textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';

    // Navigation
    const navLinks = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('.email-section, .board-section');
    navLinks.forEach(link => {
      link.addEventListener('click', (e) => {
        e.preventDefault();
        navLinks.forEach(l => l.classList.remove('active'));
        link.classList.add('active');
        sections.forEach(s => s.classList.remove('active'));
        document.querySelector(`.${link.dataset.section}`).classList.add('active');
      });
    });

    // Email Section Scripts (from File 1)
    async function copyText(text) {
      try {
        await navigator.clipboard.writeText(text);
        alert('Copied to clipboard');
      } catch (e) {
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        document.body.removeChild(ta);
        alert('Copied to clipboard');
      }
    }
    function copySubject(id) { copyText(document.getElementById(id).value); }
    function copyBody(id) { copyText(document.getElementById(id).value); }
    function copyBoth(sId, bId) {
      const s = document.getElementById(sId).value;
      const b = document.getElementById(bId).value;
      copyText('Subject: ' + s + '\n\n' + b);
    }
    function copyAll() {
      const payload = [
        { n: 'Email 1', s: document.getElementById('s1').value, b: document.getElementById('b1').value },
        { n: 'Email 2', s: document.getElementById('s2').value, b: document.getElementById('b2').value },
        { n: 'Email 3', s: document.getElementById('s3').value, b: document.getElementById('b3').value },
        { n: 'Email 4', s: document.getElementById('s4').value, b: document.getElementById('b4').value },
      ].map(e => `${e.n} ‚Äî Subject: ${e.s}\n\n${e.b}`).join('\n\n\n------------------------------\n\n');
      copyText(payload);
    }

    // Board Section Scripts (from File 2)
    const API = "https://script.google.com/macros/s/AKfycbzwXW3Aabus6brnuawF9QvXX4dpq3MM03jmi4e9rkpiJUs2B9Vo_Qp36ht5BZ7bgbM/exec";
    const CONTACTS = {
      "Taylor McGuiness ‚Äî Interaction": {
        phone: "1300 668 123", email: "info@interactionservices.org", website: "https://interactionservices.org"
      },
      "Assist Disability Services ‚Äî SSC": {
        phone: "1800 955 806", email: "enquiries@assistservices.com.au", website: "https://assistservices.com.au"
      },
      "Triniti Care ‚Äî Support Coord": { phone: "(02) 8319 9433", website: "https://triniticare.com.au" },
      "MD Home Care ‚Äî SSC": { phone: "08 6386 9999", website: "https://mdhomecare.com.au" },
      "Claremont Care ‚Äî SC/PM": { phone: "0416 873 319", website: "https://claremontcare.com.au" },
      "BRK Plan Management": { phone: "0414 704 279", email: "meet@brkpm.com.au", website: "http://brkpm.com.au" },
      "Axial Plan Management": { phone: "0416 428 261", email: "hello@axialplanmanagement.com.au", website: "https://axialplanmanagement.com.au" },
      "NADO Plan Management": { phone: "1300 738 229", website: "https://nado.org.au" },
      "Yahweh Care ‚Äî PM": { phone: "(02) 8325 1616", email: "info@yahwehcare.com.au", website: "https://yahwehcare.com.au" }
    };
    let ROWS = [];
    let edits = new Map();
    let activeCellId = null;
    function $(id) { return document.getElementById(id); }
    function setStatus(msg, dim = false) {
      $("status").textContent = msg || "";
      $("status").classList.toggle("dim", !!dim);
      $("footStatus").textContent = msg || "Ready.";
    }
    function mail(link) {
      const a = document.createElement("a");
      a.href = "mailto:" + link;
      a.textContent = "üìß " + link;
      return a;
    }
    function tel(link) {
      const a = document.createElement("a");
      a.href = "tel:" + (link || "").replace(/[^0-9+]/g, "");
      a.textContent = "‚òé " + link;
      return a;
    }
    function formatLeadCell(name) {
      const wrap = document.createElement("div");
      wrap.className = "lead";
      const nm = document.createElement("div");
      nm.className = "name";
      nm.textContent = name || "‚Äî";
      wrap.appendChild(nm);
      const info = CONTACTS[name];
      if (info) {
        const meta = document.createElement("div");
        meta.className = "meta";
        if (info.email) meta.appendChild(mail(info.email));
        if (info.phone) meta.appendChild(tel(info.phone));
        if (info.website) {
          const w = document.createElement("a");
          w.href = info.website;
          w.target = "_blank";
          w.rel = "noopener";
          w.textContent = "üåê Website";
          meta.appendChild(w);
        }
        wrap.appendChild(meta);
      }
      return wrap;
    }
    const modal = $("modalBackdrop");
    const modalTA = $("modalTextarea");
    function openModal(id, title, initial) {
      activeCellId = id;
      $("modalTitle").textContent = title || "Edit note";
      modalTA.value = initial || "";
      modal.style.display = "flex";
      modal.setAttribute("aria-hidden", "false");
      modalTA.focus();
    }
    function closeModal() {
      modal.style.display = "none";
      modal.setAttribute("aria-hidden", "true");
      activeCellId = null;
    }
    $("modalClose").addEventListener("click", closeModal);
    modal.addEventListener("click", (e) => { if (e.target === modal) closeModal(); });
    document.addEventListener("keydown", (e) => { if (e.key === "Escape" && modal.getAttribute("aria-hidden") === "false") closeModal(); });
    $("modalSave").addEventListener("click", () => {
      if (!activeCellId) return;
      const v = modalTA.value || "";
      const el = document.getElementById("cell-" + activeCellId);
      const ta = document.getElementById("ta-" + activeCellId);
      if (ta) ta.value = v;
      const pv = el.querySelector(".preview");
      const bd = el.querySelector(".badge");
      pv.textContent = v ? v.replace(/\s+/g, ' ').trim() : "Empty";
      el.classList.toggle("empty", !v);
      bd.textContent = v ? "Filled" : "Empty";
      edits.set(activeCellId, v);
      setStatus("Unsaved changes‚Ä¶");
      closeModal();
    });
    async function load() {
      try {
        setStatus("Loading‚Ä¶");
        const r = await fetch(API, { method: "GET" });
        if (!r.ok) throw new Error("Could not load. Check the API URL and deployment access is set to 'Anyone'.");
        const data = await r.json();
        ROWS = data;
        buildTable();
        setStatus("Loaded.", true);
      } catch (err) {
        console.error(err);
        setStatus(err.message || "Load failed.");
        alert(err.message || "Load failed. In Apps Script: Deploy ‚Üí Web app ‚Üí Who has access = 'Anyone'.");
      }
    }
    function buildTable() {
      const tb = $("tbody");
      tb.innerHTML = "";
      edits.clear();
      for (let r = 1; r < ROWS.length; r++) {
        const row = ROWS[r];
        const lead = row[0] || "";
        const tr = document.createElement("tr");
        const th = document.createElement("th");
        th.appendChild(formatLeadCell(lead));
        tr.appendChild(th);
        for (let c = 0; c < 7; c++) {
          const id = `${r - 1}_${c}`;
          const td = document.createElement("td");
          const ta = document.createElement("textarea");
          ta.id = "ta-" + id;
          ta.style.display = "none";
          ta.value = row[c + 1] || "";
          const cell = document.createElement("div");
          cell.className = "cell";
          if (!ta.value) cell.classList.add("empty");
          cell.id = "cell-" + id;
          const preview = document.createElement("div");
          preview.className = "preview";
          preview.textContent = ta.value ? ta.value.replace(/\s+/g, ' ').trim() : "Empty";
          const badge = document.createElement("span");
          badge.className = "badge";
          badge.textContent = ta.value ? "Filled" : "Empty";
          cell.appendChild(preview);
          cell.appendChild(badge);
          cell.addEventListener("click", () => {
            const day = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"][c];
            openModal(id, `${lead} ‚Äî ${day}`, ta.value);
          });
          td.appendChild(cell);
          td.appendChild(ta);
          tr.appendChild(td);
        }
        tb.appendChild(tr);
      }
    }
    async function save() {
      if (edits.size === 0) { setStatus("No changes to save.", true); return; }
      try {
        setStatus("Saving‚Ä¶");
        const rows = [];
        edits.forEach((value, key) => { const [ri, ci] = key.split("_").map(Number); rows.push({ rowIndex: ri, colIndex: ci, value }); });
        const resp = await fetch(API, { method: "POST", headers: { "Content-Type": "text/plain" }, body: JSON.stringify({ rows }) });
        const txt = await resp.text();
        let ok = null;
        try { ok = JSON.parse(txt); } catch (e) {}
        if (!resp.ok || !ok || !ok.ok) throw new Error(`Save failed (status ${resp.status}): ${txt.substring(0, 200)}`);
        setStatus("Saved.", true);
        edits.clear();
      } catch (err) {
        console.error(err);
        setStatus("Save failed.");
        alert(err.message || "Save failed. In Apps Script: Deploy ‚Üí Web app ‚Üí set 'Who has access' to 'Anyone' and use the /exec URL.");
      }
    }
    let armTimeout = null;
    $("btnArmClean").addEventListener("click", () => {
      if (armTimeout) clearTimeout(armTimeout);
      $("btnDoClean").disabled = false;
      $("btnArmClean").textContent = "Armed (8s)‚Ä¶";
      setStatus("Cleanup armed ‚Äî press Confirm to wipe all notes (names stay).");
      armTimeout = setTimeout(() => {
        $("btnDoClean").disabled = true;
        $("btnArmClean").textContent = "1) Arm";
        setStatus("Cleanup disarmed.", true);
      }, 8000);
    });
    $("btnDoClean").addEventListener("click", async () => {
      if ($("btnDoClean").disabled) return;
      const updates = [];
      for (let r = 1; r < ROWS.length; r++) {
        for (let c = 0; c < 7; c++) {
          const id = `${r - 1}_${c}`;
          const el = document.getElementById("cell-" + id);
          const ta = document.getElementById("ta-" + id);
          if (ta && (ta.value !== "" || el.classList.contains("empty") === false)) {
            ta.value = "";
            if (el) {
              el.classList.add("empty");
              const pv = el.querySelector(".preview");
              if (pv) pv.textContent = "Empty";
              const bd = el.querySelector(".badge");
              if (bd) bd.textContent = "Empty";
            }
            edits.set(id, "");
            updates.push({ rowIndex: r - 1, colIndex: c, value: "" });
          }
        }
      }
      if (armTimeout) clearTimeout(armTimeout);
      $("btnDoClean").disabled = true;
      $("btnArmClean").textContent = "1) Arm";
      if (updates.length === 0) { setStatus("Nothing to clear.", true); return; }
      try {
        setStatus("Wiping all notes for a fresh week‚Ä¶");
        const resp = await fetch(API, { method: "POST", headers: { "Content-Type": "text/plain" }, body: JSON.stringify({ rows: updates }) });
        const txt2 = await resp.text();
        let ok2 = null;
        try { ok2 = JSON.parse(txt2); } catch (e) {}
        if (!resp.ok || !ok2 || !ok2.ok) throw new Error(`Cleanup save failed (status ${resp.status}): ${txt2.substring(0, 200)}`);
        edits.clear();
        setStatus("All notes cleared. Fresh week ready ‚úÖ", true);
      } catch (err) {
        console.error(err);
        setStatus("Cleanup failed.");
        alert(err.message || "Cleanup failed. Check Web App permissions or try again.");
      }
    });
    load();
  </script>
</body>
</html>
