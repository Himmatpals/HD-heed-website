<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>HD HeeD — Client Master Suite (v4 Integrated)</title>
<style>
:root{--ink:#0b1220;--muted:#6b7280;--brand:#512b8a;--accent:#8b5cf6;--danger:#ef4444;--card:#fff}
*{box-sizing:border-box}
body{margin:0;font-family:Inter,Segoe UI,Roboto,Arial,sans-serif;background:linear-gradient(135deg,#f5f3ff 0,#f8fafc 50%,#eef2ff 100%);color:var(--ink)}
.container{max-width:1200px;margin:24px auto 80px;padding:0 16px}
.header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:16px}
.brand{display:flex;align-items:center;gap:12px}
.logo{width:44px;height:44px;border-radius:12px;background:radial-gradient(120% 120% at 0 0,#a78bfa 0,#7c3aed 40%,#512b8a 100%);display:grid;place-items:center;color:#fff;font-weight:800;letter-spacing:.5px;box-shadow:0 8px 24px rgba(81,43,138,.25)}
.title h1{margin:0;font-size:22px}
.title p{margin:2px 0 0;color:var(--muted);font-size:13px}
.actions{display:flex;flex-wrap:wrap;gap:8px}
button{appearance:none;border:0;border-radius:12px;padding:10px 14px;font-weight:600;cursor:pointer;box-shadow:0 4px 14px rgba(0,0,0,.06)}
.btn-primary{background:var(--brand);color:#fff}
.btn-ghost{background:#fff;color:var(--brand);border:1px solid #e5e7eb}
.btn-danger{background:var(--danger);color:#fff}
.badge{display:inline-block;background:#ede9fe;color:#4c1d95;border-radius:999px;padding:4px 10px;font-size:12px;font-weight:700;letter-spacing:.3px}
.tabs{display:flex;gap:8px;flex-wrap:wrap;margin:12px 0}
.tab{background:#fff;border:1px solid #e5e7eb;border-radius:999px;padding:8px 12px;font-weight:700;color:#4c1d95;cursor:pointer}
.tab.active{background:linear-gradient(90deg,#ede9fe,#fff);border-color:#d8b4fe;box-shadow:0 6px 18px rgba(81,43,138,.12)}
.section{display:none}
.section.active{display:block}
.card{background:var(--card);border-radius:16px;padding:16px 16px 8px;border:1px solid #e5e7eb;box-shadow:0 10px 30px rgba(81,43,138,.07);margin-bottom:14px}
.card h2{display:flex;align-items:center;justify-content:space-between;gap:8px;margin:0 0 10px;font-size:15px;text-transform:uppercase;letter-spacing:.6px;color:#4b5563}
.card h3{margin:12px 0 8px;font-size:14px;color:#374151}
.grid{display:grid;gap:16px}
.grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
@media (max-width:980px){.grid.cols-2{grid-template-columns:1fr}}
.row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
@media (max-width:760px){.row{grid-template-columns:1fr}}
label{font-size:12px;color:#6b7280;margin-bottom:6px;display:block}
input[type="text"],input[type="date"],input[type="tel"],input[type="email"],textarea,select{
  width:100%;padding:10px 12px;border:1px solid #e5e7eb;border-radius:10px;background:#fff;font-size:14px;outline:none;transition:box-shadow .15s,border-color .15s
}
textarea{min-height:90px;resize:vertical}
input:focus,textarea:focus,select:focus{border-color:#c7d2fe;box-shadow:0 0 0 4px rgba(99,102,241,.15)}
.kv{display:grid;grid-template-columns:220px 1fr;gap:10px;align-items:center;margin:6px 0}
@media (max-width:700px){.kv{grid-template-columns:1fr}}
.checks{display:flex;flex-wrap:wrap;gap:10px}
.checks label{display:inline-flex;align-items:center;gap:8px;background:#fff;border:1px solid #e5e7eb;border-radius:10px;padding:6px 10px;font-size:13px;color:#111827}
.table{width:100%;border-collapse:collapse;margin-top:6px}
.table th,.table td{border:1px solid #e5e7eb;padding:8px;font-size:13px}
.table th{background:#f9fafb;text-align:left;color:#374151}
.hr{height:1px;background:linear-gradient(90deg,#e5e7eb 0,#ede9fe 50%,#e5e7eb 100%);margin:10px 0}
.note{background:#f8fafc;border:1px dashed #dbeafe;border-radius:12px;padding:10px;font-size:12px;color:#334155;margin-bottom:10px}
@media print{.actions,.tabs,button{display:none !important}body{background:#fff}.container{margin:0;max-width:100%;padding:0 8mm}.card{box-shadow:none;border-color:#e5e7eb;page-break-inside:avoid}}
</style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="brand">
        <div class="logo">HD</div>
        <div class="title">
          <h1>Client Master Suite (v4 Integrated)</h1>
          <p>All-in-one: Registration, Profile & Plan, Medical, Risk, and Overview. Autosaves · Print to PDF · Export Editable RTF</p>
        </div>
      </div>
      <div class="actions">
        <button class="btn-ghost" id="saveBtn">Save</button>
        <button class="btn-ghost" id="exportBtn">Export Editable RTF</button>
        <button class="btn-danger" id="clearBtn">Clear</button>
        <button class="btn-primary" onclick="window.print()">Print to PDF</button>
      </div>
    </div>

    <div class="tabs">
      <div class="tab active" data-tab="overview">Overview</div>
      <div class="tab" data-tab="registration">Registration</div>
      <div class="tab" data-tab="profile">Profile & Plan</div>
      <div class="tab" data-tab="medical">Medical</div>
      <div class="tab" data-tab="risk">Risk</div>
    </div>

    <!-- OVERVIEW -->
    <div class="section active" id="overview">
      <div class="note">Quick shift-facing summary and key care items. This condenses the other tabs.</div>
      <div class="grid cols-2">
        <div class="card">
          <h2>General Quick View</h2>
          <div class="row">
            <div><label>Client Name</label><input id="o_name" type="text"></div>
            <div><label>DOB</label><input id="o_dob" type="text" placeholder="DD-MM-YYYY"></div>
          </div>
          <div class="row">
            <div><label>NDIS Number</label><input id="o_ndis" type="text"></div>
            <div><label>Plan Dates</label><input id="o_plan" type="text" placeholder="Start – End"></div>
          </div>
          <div class="kv"><label>Primary Contact</label><input id="o_primary" type="text" placeholder="Name · Phone · Email"></div>
          <div class="kv"><label>Communication</label><input id="o_comm" type="text" placeholder="Language/interpreter; key tips"></div>
        </div>
        <div class="card">
          <h2>Today’s Actions</h2>
          <div class="kv"><label>Medication</label><input id="o_med" type="text" placeholder="Level; key times; PRN rule"></div>
          <div class="kv"><label>High-Intensity</label><input id="o_hi" type="text" placeholder="e.g., stoma change; wound; BGL"></div>
          <div class="kv"><label>Mobility</label><input id="o_mob" type="text" placeholder="Aid; transfer; supervision"></div>
          <div class="kv"><label>Emergency / Red Flags</label><input id="o_red" type="text" placeholder="When to call 000; who to notify"></div>
          <div class="hr"></div>
          <textarea id="o_check" placeholder="☐ Meds documented  ☐ High-intensity done  ☐ Safety adhered  ☐ Progress note completed"></textarea>
        </div>
      </div>

      <div class="card">
        <h2>Key Care Plans</h2>
        <div class="row">
          <div><label>Stoma</label><textarea id="o_stoma"></textarea></div>
          <div><label>Wound</label><textarea id="o_wound"></textarea></div>
        </div>
        <div class="row">
          <div><label>Diabetes</label><textarea id="o_diabetes"></textarea></div>
          <div><label>Behaviour Support</label><textarea id="o_bsp"></textarea></div>
        </div>
      </div>
    </div>

    <!-- REGISTRATION (from Participant Intake & Registration) -->
    <div class="section" id="registration">
      <div class="card">
        <h2>Participant Details</h2>
        <div class="row">
          <div><label>Full Name</label><input id="r_name" type="text"></div>
          <div><label>Date of Birth</label><input id="r_dob" type="text"></div>
        </div>
        <div class="row">
          <div><label>Gender</label>
            <select id="r_gender"><option value=""></option><option>Male</option><option>Female</option><option>Other</option><option>Prefer not to say</option></select>
          </div>
          <div><label>NDIS Number</label><input id="r_ndis" type="text"></div>
        </div>
        <div class="row">
          <div><label>Plan Start</label><input id="r_plan_start" type="text"></div>
          <div><label>Plan End</label><input id="r_plan_end" type="text"></div>
        </div>
        <div class="row">
          <div><label>Address</label><input id="r_address" type="text"></div>
          <div><label>Phone / Email</label><input id="r_contact" type="text"></div>
        </div>
      </div>
      <div class="card">
        <h2>Primary / Emergency Contacts</h2>
        <div class="row">
          <div><label>Primary Contact (Name • Relationship)</label><input id="r_primary" type="text"></div>
          <div><label>Primary Contact (Phone • Email)</label><input id="r_primary_ce" type="text"></div>
        </div>
        <div class="row">
          <div><label>Emergency (Name • Relationship)</label><input id="r_emerg" type="text"></div>
          <div><label>Emergency (Phone)</label><input id="r_emerg_p" type="text"></div>
        </div>
      </div>
      <div class="card">
        <h2>NDIS Plan Management</h2>
        <div class="row">
          <div>
            <label>Plan managed by</label>
            <div class="checks">
              <label><input type="checkbox" id="r_m_ndia"> NDIA</label>
              <label><input type="checkbox" id="r_m_plan"> Plan Managed</label>
              <label><input type="checkbox" id="r_m_self"> Self-Managed</label>
            </div>
          </div>
          <div><label>Plan Manager (Name • Org • Contact • Email)</label><input id="r_manager" type="text"></div>
        </div>
        <div class="row">
          <div><label>Support Coordinator (Name • Org • Phone • Email)</label><input id="r_sc" type="text"></div>
          <div><label>Preferred Communication</label>
            <div class="checks">
              <label><input type="checkbox" id="r_c_phone"> Phone</label>
              <label><input type="checkbox" id="r_c_email"> Email</label>
              <label><input type="checkbox" id="r_c_person"> In person</label>
              <label><input type="checkbox" id="r_c_sc"> Through support coordinator</label>
            </div>
          </div>
        </div>
        <div class="row">
          <div><label>Interpreter required?</label>
            <div class="checks">
              <label><input type="checkbox" id="r_i_yes"> Yes</label>
              <label><input type="checkbox" id="r_i_no"> No</label>
            </div>
          </div>
          <div><label>Language</label><input id="r_lang" type="text"></div>
        </div>
      </div>
      <div class="card">
        <h2>Goals, Interests & Cultural</h2>
        <div class="kv"><label>Participant Goals & Interests</label><textarea id="r_goals"></textarea></div>
        <div class="row">
          <div><label>Cultural background</label><input id="r_culture" type="text"></div>
          <div><label>Religious/spiritual needs</label><input id="r_relig" type="text"></div>
        </div>
        <div class="kv"><label>Dietary requirements</label><input id="r_diet" type="text"></div>
      </div>
      <div class="card">
        <h2>Disability & Support Needs</h2>
        <div class="row">
          <div><label>Primary Disability</label><input id="r_primary_dx" type="text"></div>
          <div><label>Other Conditions</label><input id="r_other_dx" type="text"></div>
        </div>
        <div class="row">
          <div><label>Mobility Aids</label><input id="r_mob_aids" type="text"></div>
          <div><label>Communication Needs</label>
            <div class="checks">
              <label><input type="checkbox" id="r_v"> Verbal</label>
              <label><input type="checkbox" id="r_nv"> Non-verbal</label>
              <label><input type="checkbox" id="r_aac"> Uses AAC</label>
              <label><input type="checkbox" id="r_support"> Requires support</label>
            </div>
          </div>
        </div>
        <div class="kv"><label>Support Needs</label>
          <div class="checks">
            <label><input type="checkbox" id="r_s_pc"> Personal care</label>
            <label><input type="checkbox" id="r_s_med"> Medication</label>
            <label><input type="checkbox" id="r_s_ca"> Community access</label>
            <label><input type="checkbox" id="r_s_trans"> Transport</label>
            <label><input type="checkbox" id="r_s_house"> Household tasks</label>
            <label><input type="checkbox" id="r_s_bsp"> Behaviour support</label>
            <label><input type="checkbox" id="r_s_hi"> High intensity care</label>
          </div>
        </div>
      </div>
      <div class="card">
        <h2>Consent & Signature</h2>
        <div class="row">
          <div><label>Participant / Nominee (Name • Relationship)</label><input id="r_signer" type="text"></div>
          <div><label>Date</label><input id="r_sign_date" type="text"></div>
        </div>
        <div class="row">
          <div><label>HD HEED Representative (Name • Position)</label><input id="r_rep" type="text"></div>
          <div><label>Date</label><input id="r_rep_date" type="text"></div>
        </div>
      </div>
    </div>

    <!-- PROFILE & SUPPORT PLAN -->
    <div class="section" id="profile">
      <div class="card">
        <h2>Participant Overview</h2>
        <div class="row">
          <div><label>Preferred Name</label><input id="p_pref" type="text"></div>
          <div><label>Primary Disability</label><input id="p_primary_dx" type="text"></div>
        </div>
        <div class="row">
          <div><label>Other Diagnoses</label><input id="p_other_dx" type="text"></div>
          <div><label>Communication Needs</label>
            <div class="checks">
              <label><input type="checkbox" id="p_v"> Verbal</label>
              <label><input type="checkbox" id="p_nv"> Non-verbal</label>
              <label><input type="checkbox" id="p_aac"> Uses AAC</label>
              <label><input type="checkbox" id="p_interp"> Requires Interpreter</label>
            </div>
          </div>
        </div>
        <div class="kv"><label>Cultural/Religious Needs</label><input id="p_cultural" type="text"></div>
      </div>
      <div class="card">
        <h2>Goals (NDIS / Participant)</h2>
        <textarea id="p_goals"></textarea>
      </div>
      <div class="card">
        <h2>Daily Routines & Preferences</h2>
        <div class="row">
          <div><label>Morning Routine</label><textarea id="p_morning"></textarea></div>
          <div><label>Meal/Dietary</label><textarea id="p_meal"></textarea></div>
        </div>
        <div class="row">
          <div><label>Sleep Pattern</label><textarea id="p_sleep"></textarea></div>
          <div><label>Likes / Dislikes</label><textarea id="p_likes"></textarea></div>
        </div>
        <div class="kv"><label>Leisure Interests</label><textarea id="p_leisure"></textarea></div>
      </div>
      <div class="card">
        <h2>Support Requirements</h2>
        <div class="checks">
          <label><input type="checkbox" id="p_s_pc"> Personal care</label>
          <label><input type="checkbox" id="p_s_meal"> Meal prep/feeding</label>
          <label><input type="checkbox" id="p_s_ca"> Community access</label>
          <label><input type="checkbox" id="p_s_med"> Medication assistance</label>
          <label><input type="checkbox" id="p_s_trans"> Transport</label>
          <label><input type="checkbox" id="p_s_bsp"> Behaviour support</label>
          <label><input type="checkbox" id="p_s_hi"> High-intensity supports</label>
        </div>
        <div class="kv"><label>Frequency & Duration</label><textarea id="p_freq"></textarea></div>
      </div>
      <div class="card">
        <h2>Health & Safety</h2>
        <div class="row">
          <div><label>Allergies</label><input id="p_allergies" type="text"></div>
          <div><label>Mobility Equipment</label><input id="p_mob_equip" type="text"></div>
        </div>
        <div class="kv"><label>Risk Factors (summary)</label><textarea id="p_risks"></textarea></div>
        <div class="kv"><label>Emergency Plan in place?</label>
          <div class="checks">
            <label><input type="checkbox" id="p_ep_yes"> Yes</label>
            <label><input type="checkbox" id="p_ep_no"> No</label>
          </div>
        </div>
      </div>
      <div class="card">
        <h2>Support Worker Guidelines</h2>
        <div class="row">
          <div><label>Communication Tips</label><textarea id="p_tips"></textarea></div>
          <div><label>Behavioural Triggers / Calming</label><textarea id="p_triggers"></textarea></div>
        </div>
        <div class="row">
          <div><label>Supervision Level</label>
            <select id="p_supervision"><option></option><option>None</option><option>Occasional</option><option>Constant</option></select>
          </div>
          <div><label>Restrictive Practices?</label>
            <div class="checks">
              <label><input type="checkbox" id="p_rp_yes"> Yes</label>
              <label><input type="checkbox" id="p_rp_no"> No</label>
            </div>
          </div>
        </div>
      </div>
      <div class="card">
        <h2>Monitoring & Review</h2>
        <div class="row">
          <div><label>First Review Due</label><input id="p_review_due" type="text"></div>
          <div><label>Follow-up Notes</label><input id="p_follow" type="text"></div>
        </div>
      </div>
    </div>

    <!-- MEDICAL SUMMARY -->
    <div class="section" id="medical">
      <div class="card">
        <h2>Identifiers</h2>
        <div class="row">
          <div><label>Participant Name</label><input id="m_name" type="text"></div>
          <div><label>NDIS Number</label><input id="m_ndis" type="text"></div>
        </div>
        <div class="row">
          <div><label>DOB</label><input id="m_dob" type="text"></div>
          <div><label>Date Completed</label><input id="m_date" type="text"></div>
        </div>
      </div>
      <div class="card">
        <h2>1) General Practitioner (GP)</h2>
        <div class="row">
          <div><label>Name</label><input id="m_gp_name" type="text"></div>
          <div><label>Clinic Name</label><input id="m_gp_clinic" type="text"></div>
        </div>
        <div class="row">
          <div><label>Phone</label><input id="m_gp_phone" type="text"></div>
          <div><label>Fax</label><input id="m_gp_fax" type="text"></div>
        </div>
      </div>
      <div class="card">
        <h2>2) Pharmacy</h2>
        <div class="row">
          <div><label>Pharmacy Name</label><input id="m_ph_name" type="text"></div>
          <div><label>Contact Person</label><input id="m_ph_contact" type="text"></div>
        </div>
        <div class="row">
          <div><label>Phone</label><input id="m_ph_phone" type="text"></div>
          <div><label>Email/Fax</label><input id="m_ph_email" type="text"></div>
        </div>
      </div>
      <div class="card">
        <h2>3) Medical Conditions / Diagnoses</h2>
        <textarea id="m_dx"></textarea>
      </div>
      <div class="card">
        <h2>4) Allergies</h2>
        <div class="checks" style="margin-bottom:8px">
          <label><input type="checkbox" id="m_nkda"> No known allergies</label>
        </div>
        <textarea id="m_allergies" placeholder="Known allergies (list)"></textarea>
      </div>
      <div class="card">
        <h2>5) Medications</h2>
        <table class="table" id="m_medTable">
          <thead><tr><th>Medication</th><th>Dosage</th><th>Frequency</th><th>Route</th><th>Notes</th></tr></thead>
          <tbody><tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr></tbody>
        </table>
        <div style="margin-top:8px;display:flex;gap:8px">
          <button class="btn-ghost" id="m_addMed">Add Medicine</button>
          <button class="btn-ghost" id="m_delMed">Delete Last</button>
        </div>
        <div class="kv" style="margin-top:8px">
          <label>Administration level</label>
          <div class="checks">
            <label><input type="checkbox" id="m_self"> Participant self-administers</label>
            <label><input type="checkbox" id="m_assist"> Requires assistance</label>
            <label><input type="checkbox" id="m_rn"> Administered by RN</label>
          </div>
        </div>
      </div>
      <div class="card">
        <h2>6) Specialist Contacts</h2>
        <table class="table" id="m_specTable">
          <thead><tr><th>Specialist Type</th><th>Name</th><th>Contact</th><th>Frequency of Review</th></tr></thead>
          <tbody><tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr></tbody>
        </table>
        <div style="margin-top:8px;display:flex;gap:8px">
          <button class="btn-ghost" id="m_addSpec">Add Specialist</button>
          <button class="btn-ghost" id="m_delSpec">Delete Last</button>
        </div>
      </div>
      <div class="card">
        <h2>7) Relevant Medical History / Hospitalisations</h2>
        <textarea id="m_history"></textarea>
      </div>
      <div class="card">
        <h2>8) Medical Equipment</h2>
        <div class="checks">
          <label><input type="checkbox" id="m_eq_catheter"> Catheter</label>
          <label><input type="checkbox" id="m_eq_peg"> PEG</label>
          <label><input type="checkbox" id="m_eq_oxy"> Oxygen</label>
          <label><input type="checkbox" id="m_eq_mob"> Mobility Aids</label>
          <label><input type="checkbox" id="m_eq_other"> Other</label>
        </div>
        <div class="kv"><label>Other details</label><input id="m_eq_other_txt" type="text"></div>
      </div>
      <div class="card">
        <h2>9) Emergency Action Plan</h2>
        <div class="kv">
          <label>Plan exists?</label>
          <div class="checks">
            <label><input type="checkbox" id="m_eap_yes"> Yes</label>
            <label><input type="checkbox" id="m_eap_no"> No</label>
          </div>
        </div>
        <textarea id="m_eap" placeholder="Attach or describe"></textarea>
      </div>
      <div class="card">
        <h2>Acknowledgements</h2>
        <div class="row">
          <div><label>Participant/Nominee Name</label><input id="m_ack_name" type="text"></div>
          <div><label>Relationship</label><input id="m_ack_rel" type="text"></div>
        </div>
        <div class="row">
          <div><label>Signature (type name)</label><input id="m_ack_sig" type="text"></div>
          <div><label>Date</label><input id="m_ack_date" type="text"></div>
        </div>
        <div class="row">
          <div><label>HD HEED Rep Name</label><input id="m_rep_name" type="text"></div>
          <div><label>Position</label><input id="m_rep_pos" type="text"></div>
        </div>
        <div class="row">
          <div><label>Rep Date</label><input id="m_rep_date" type="text"></div>
          <div></div>
        </div>
      </div>
    </div>

    <!-- RISK ASSESSMENT -->
    <div class="section" id="risk">
      <div class="card">
        <h2>1) Home Environment Risks</h2>
        <div class="checks">
          <label><input type="checkbox" id="k_trip"> Trip hazards</label>
          <label><input type="checkbox" id="k_access"> Limited access</label>
          <label><input type="checkbox" id="k_fire"> Fire hazards</label>
          <label><input type="checkbox" id="k_storage"> Unsafe storage of meds/chemicals</label>
          <label><input type="checkbox" id="k_pets"> Pets risk</label>
          <label><input type="checkbox" id="k_other"> Other</label>
        </div>
        <div class="kv"><label>Comments/Actions</label><textarea id="k_home_comments"></textarea></div>
      </div>
      <div class="card">
        <h2>2) Health-Related Risks</h2>
        <div class="checks">
          <label><input type="checkbox" id="k_sz"> Seizures/epilepsy</label>
          <label><input type="checkbox" id="k_dm"> Diabetes</label>
          <label><input type="checkbox" id="k_pressure"> Pressure injury risk</label>
          <label><input type="checkbox" id="k_choke"> Choking/swallowing difficulty</label>
          <label><input type="checkbox" id="k_medside"> Med side effects/non-compliance</label>
          <label><input type="checkbox" id="k_allergy"> Allergies/anaphylaxis</label>
          <label><input type="checkbox" id="k_complex"> Complex procedures</label>
          <label><input type="checkbox" id="k_other_h"> Other</label>
        </div>
        <div class="kv"><label>Comments/Actions</label><textarea id="k_health_comments"></textarea></div>
      </div>
      <div class="card">
        <h2>3) Behavioural or Social Risks</h2>
        <div class="checks">
          <label><input type="checkbox" id="k_aggr"> Aggression/self-harm history</label>
          <label><input type="checkbox" id="k_engage"> Difficulty engaging</label>
          <label><input type="checkbox" id="k_abscond"> Absconding/wandering</label>
          <label><input type="checkbox" id="k_resist"> Resistance to care</label>
          <label><input type="checkbox" id="k_rp"> Restrictive practices used</label>
          <label><input type="checkbox" id="k_other_b"> Other</label>
        </div>
        <div class="kv"><label>Comments/Actions</label><textarea id="k_beh_comments"></textarea></div>
      </div>
      <div class="card">
        <h2>4) Mobility and Transfer Risks</h2>
        <div class="checks">
          <label><input type="checkbox" id="k_falls"> Falls risk</label>
          <label><input type="checkbox" id="k_hoist"> Requires hoist/manual handling</label>
          <label><input type="checkbox" id="k_aids"> Needs mobility aids</label>
          <label><input type="checkbox" id="k_gait"> Uneven gait/unsteady</label>
          <label><input type="checkbox" id="k_other_m"> Other</label>
        </div>
        <div class="kv"><label>Comments/Actions</label><textarea id="k_mob_comments"></textarea></div>
      </div>
      <div class="card">
        <h2>5) Transport & Community Access</h2>
        <div class="checks">
          <label><input type="checkbox" id="k_pt"> Difficulty with public transport</label>
          <label><input type="checkbox" id="k_travel"> Requires travel support</label>
          <label><input type="checkbox" id="k_disor"> Disorientation in public</label>
          <label><input type="checkbox" id="k_other_t"> Other</label>
        </div>
        <div class="kv"><label>Comments/Actions</label><textarea id="k_trans_comments"></textarea></div>
      </div>
      <div class="card">
        <h2>6) Emergency Preparedness</h2>
        <div class="checks">
          <label><input type="checkbox" id="k_understand"> Understands procedures</label>
          <label><input type="checkbox" id="k_contact"> Emergency contact available</label>
          <label><input type="checkbox" id="k_norespond"> May not respond to alarms</label>
          <label><input type="checkbox" id="k_evac"> Requires evacuation support</label>
          <label><input type="checkbox" id="k_other_e"> Other</label>
        </div>
        <div class="kv"><label>Comments/Actions</label><textarea id="k_emerg_comments"></textarea></div>
      </div>
      <div class="card">
        <h2>Overall & Follow-up</h2>
        <div class="row">
          <div><label>Overall Risk Rating</label>
            <select id="k_overall"><option></option><option>Low</option><option>Moderate</option><option>High</option></select>
          </div>
          <div><label>Follow-up Actions</label>
            <div class="checks">
              <label><input type="checkbox" id="k_fu_plan"> Develop Risk Management Plan</label>
              <label><input type="checkbox" id="k_fu_notify"> Notify RN/Team Leader</label>
              <label><input type="checkbox" id="k_fu_reassess"> Schedule reassessment</label>
              <label><input type="checkbox" id="k_fu_other"> Other</label>
            </div>
          </div>
        </div>
        <div class="row">
          <div><label>Participant/Nominee Signature (type name)</label><input id="k_sig" type="text"></div>
          <div><label>Date</label><input id="k_sig_date" type="text"></div>
        </div>
        <div class="row">
          <div><label>HD HEED Representative (Name • Position)</label><input id="k_rep" type="text"></div>
          <div><label>Date</label><input id="k_rep_date" type="text"></div>
        </div>
      </div>
    </div>

  </div>

<script>
// Tabs
document.querySelectorAll('.tab').forEach(t=>{
  t.addEventListener('click', ()=>{
    document.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));
    document.querySelectorAll('.section').forEach(s=>s.classList.remove('active'));
    t.classList.add('active');
    document.getElementById(t.dataset.tab).classList.add('active');
  });
});

// Table add/delete
function addRow(tableId, cols){ const tb=document.querySelector('#'+tableId+' tbody'); const tr=document.createElement('tr'); let html=''; for(let i=0;i<cols;i++){ html+='<td contenteditable="true"></td>'; } tr.innerHTML=html; tb.appendChild(tr); saveForm(); }
function delRow(tableId){ const tb=document.querySelector('#'+tableId+' tbody'); if(tb.rows.length>0){ tb.deleteRow(tb.rows.length-1); saveForm(); }}
const btns=[['m_addMed','m_delMed','m_medTable',5],['m_addSpec','m_delSpec','m_specTable',4]];
btns.forEach(([a,d,t,c])=>{ document.getElementById(a).addEventListener('click',()=>addRow(t,c)); document.getElementById(d).addEventListener('click',()=>delRow(t)); });

// Autosave
function getAllInputs(){
  const data={rows:{meds:[],specs:[]},checks:{}};
  document.querySelectorAll('input, textarea, select').forEach(el=>{
    if(el.type==='checkbox'){ data.checks[el.id]=el.checked; }
    else{ data[el.id]=el.value; }
  });
  // tables
  document.querySelectorAll('#m_medTable tbody tr').forEach(tr=>{
    const row=[]; tr.querySelectorAll('td').forEach(td=>row.push(td.innerText)); data.rows.meds.push(row);
  });
  document.querySelectorAll('#m_specTable tbody tr').forEach(tr=>{
    const row=[]; tr.querySelectorAll('td').forEach(td=>row.push(td.innerText)); data.rows.specs.push(row);
  });
  return data;
}
function setAllInputs(data){
  if(!data) return;
  document.querySelectorAll('input, textarea, select').forEach(el=>{
    if(el.type==='checkbox'){ el.checked = (data.checks||{})[el.id] || false; }
    else if(data[el.id]!==undefined){ el.value = data[el.id]; }
  });
  // tables
  const meds=data.rows?.meds||[]; const tbm=document.querySelector('#m_medTable tbody'); tbm.innerHTML='';
  meds.forEach(r=>{ const tr=document.createElement('tr'); tr.innerHTML = `<td contenteditable="true">${r[0]||''}</td><td contenteditable="true">${r[1]||''}</td><td contenteditable="true">${r[2]||''}</td><td contenteditable="true">${r[3]||''}</td><td contenteditable="true">${r[4]||''}</td>`; tbm.appendChild(tr); });
  if(tbm.rows.length===0){ addRow('m_medTable',5); }
  const specs=data.rows?.specs||[]; const tbs=document.querySelector('#m_specTable tbody'); tbs.innerHTML='';
  specs.forEach(r=>{ const tr=document.createElement('tr'); tr.innerHTML = `<td contenteditable="true">${r[0]||''}</td><td contenteditable="true">${r[1]||''}</td><td contenteditable="true">${r[2]||''}</td><td contenteditable="true">${r[3]||''}</td>`; tbs.appendChild(tr); });
  if(tbs.rows.length===0){ addRow('m_specTable',4); }
}
function saveForm(){ localStorage.setItem('hd_v4_master', JSON.stringify(getAllInputs())); }
function loadForm(){ const raw=localStorage.getItem('hd_v4_master'); if(raw){ try{ setAllInputs(JSON.parse(raw)); }catch(e){} } }
document.getElementById('saveBtn').addEventListener('click', saveForm);
document.getElementById('clearBtn').addEventListener('click', ()=>{ if(confirm('Clear all fields and local save?')){ localStorage.removeItem('hd_v4_master'); location.reload(); }});
document.querySelectorAll('input, textarea, select').forEach(el=>el.addEventListener('input', saveForm));
loadForm();

// Export Editable RTF
function rtfEscape(s){ return (s||'').replace(/\\/g,'\\\\').replace(/{/g,'\\{').replace(/}/g,'\\}').replace(/\\n/g,'\\par '); }
function exportTable(id, headers){
  const tb=document.querySelector('#'+id+' tbody'); let out=''; if(!tb) return out;
  const rows=[]; tb.querySelectorAll('tr').forEach(tr=>{ const cells=[]; tr.querySelectorAll('td').forEach(td=>cells.push(td.innerText.trim())); if(cells.join('').trim()!==''){ rows.push(cells); } });
  if(rows.length){ out+='\\b '+rtfEscape(headers.join(' | '))+'\\b0\\par '; rows.forEach(r=>{ out+= rtfEscape(r.join(' | '))+'\\par '; }); out+='\\par '; }
  return out;
}
document.getElementById('exportBtn').addEventListener('click', function(){
  const d=getAllInputs();
  function v(id){ return d[id]||''; }
  function chk(id,label){ return d.checks[id] ? ('• '+label+'\\par ') : ''; }
  let r='{\\rtf1\\ansi\\deff0{\\fonttbl{\\f0 Arial;}}\\fs22';
  function h1(t){ r+='\\par\\b '+rtfEscape(t)+'\\b0\\par '; }
  function line(lbl, val){ if((val||'').trim()!==''){ r+='\\b '+rtfEscape(lbl)+':\\b0 '+rtfEscape(val)+'\\par '; } }

  // OVERVIEW
  h1('OVERVIEW');
  line('Client Name', v('o_name')); line('DOB', v('o_dob')); line('NDIS Number', v('o_ndis')); line('Plan Dates', v('o_plan'));
  line('Primary Contact', v('o_primary')); line('Communication', v('o_comm'));
  line('Medication (Today)', v('o_med')); line('High-Intensity', v('o_hi')); line('Mobility', v('o_mob'));
  line('Emergency / Red Flags', v('o_red')); line('Shift Checklist', v('o_check'));
  line('Stoma', v('o_stoma')); line('Wound', v('o_wound')); line('Diabetes', v('o_diabetes')); line('Behaviour Support', v('o_bsp'));

  // REGISTRATION
  h1('REGISTRATION');
  line('Full Name', v('r_name')); line('DOB', v('r_dob')); line('Gender', v('r_gender')); line('NDIS', v('r_ndis'));
  line('Plan Start', v('r_plan_start')); line('Plan End', v('r_plan_end')); line('Address', v('r_address')); line('Phone/Email', v('r_contact'));
  line('Primary Contact', v('r_primary')); line('Primary Contact (Phone/Email)', v('r_primary_ce'));
  line('Emergency Contact', v('r_emerg')); line('Emergency Phone', v('r_emerg_p'));
  r+=chk('r_m_ndia','NDIA')+chk('r_m_plan','Plan Managed')+chk('r_m_self','Self-Managed');
  line('Plan Manager', v('r_manager')); line('Support Coordinator', v('r_sc'));
  r+=chk('r_c_phone','Pref: Phone')+chk('r_c_email','Pref: Email')+chk('r_c_person','Pref: In person')+chk('r_c_sc','Pref: Through SC');
  r+=chk('r_i_yes','Interpreter: Yes')+chk('r_i_no','Interpreter: No'); line('Language', v('r_lang'));
  line('Goals & Interests', v('r_goals')); line('Cultural background', v('r_culture')); line('Religious needs', v('r_relig')); line('Dietary', v('r_diet'));
  line('Primary Disability', v('r_primary_dx')); line('Other Conditions', v('r_other_dx')); line('Mobility Aids', v('r_mob_aids'));
  r+=chk('r_v','Verbal')+chk('r_nv','Non-verbal')+chk('r_aac','Uses AAC')+chk('r_support','Requires support');
  r+=chk('r_s_pc','Personal care')+chk('r_s_med','Medication')+chk('r_s_ca','Community access')+chk('r_s_trans','Transport')+chk('r_s_house','Household')+chk('r_s_bsp','Behaviour support')+chk('r_s_hi','High intensity');
  line('Signer', v('r_signer')); line('Sign Date', v('r_sign_date')); line('HD Rep', v('r_rep')); line('Rep Date', v('r_rep_date'));

  // PROFILE & PLAN
  h1('PROFILE & SUPPORT PLAN');
  line('Preferred Name', v('p_pref')); line('Primary Disability', v('p_primary_dx')); line('Other Diagnoses', v('p_other_dx'));
  r+=chk('p_v','Verbal')+chk('p_nv','Non-verbal')+chk('p_aac','Uses AAC')+chk('p_interp','Interpreter');
  line('Cultural/Religious', v('p_cultural')); line('Goals', v('p_goals'));
  line('Morning Routine', v('p_morning')); line('Meal/Diet', v('p_meal')); line('Sleep Pattern', v('p_sleep')); line('Likes/Dislikes', v('p_likes')); line('Leisure', v('p_leisure'));
  r+=chk('p_s_pc','Personal care')+chk('p_s_meal','Meal/Feeding')+chk('p_s_ca','Community access')+chk('p_s_med','Medication')+chk('p_s_trans','Transport')+chk('p_s_bsp','Behaviour support')+chk('p_s_hi','High intensity');
  line('Frequency & Duration', v('p_freq'));
  line('Allergies', v('p_allergies')); line('Mobility Equipment', v('p_mob_equip')); line('Risk Factors', v('p_risks')); r+=chk('p_ep_yes','Emergency Plan: Yes')+chk('p_ep_no','Emergency Plan: No');
  line('Communication Tips', v('p_tips')); line('Triggers/Calming', v('p_triggers')); line('Supervision Level', v('p_supervision'));
  r+=chk('p_rp_yes','Restrictive Practices: Yes')+chk('p_rp_no','Restrictive Practices: No');
  line('First Review Due', v('p_review_due')); line('Follow-up', v('p_follow'));

  // MEDICAL
  h1('MEDICAL SUMMARY');
  line('Name', v('m_name')); line('NDIS', v('m_ndis')); line('DOB', v('m_dob')); line('Date Completed', v('m_date'));
  line('GP Name', v('m_gp_name')); line('GP Clinic', v('m_gp_clinic')); line('GP Phone', v('m_gp_phone')); line('GP Fax', v('m_gp_fax'));
  line('Pharmacy', v('m_ph_name')); line('Pharmacy Contact', v('m_ph_contact')); line('Pharmacy Phone', v('m_ph_phone')); line('Pharmacy Email/Fax', v('m_ph_email'));
  line('Diagnoses', v('m_dx')); r+=chk('m_nkda','No known allergies'); line('Allergies', v('m_allergies'));
  r+=exportTable('m_medTable', ['Medication','Dosage','Frequency','Route','Notes']);
  r+=chk('m_self','Self-administers')+chk('m_assist','Requires assistance')+chk('m_rn','Admin by RN');
  r+=exportTable('m_specTable', ['Specialist Type','Name','Contact','Frequency of Review']);
  line('Medical History/Hospitalisations', v('m_history'));
  r+=chk('m_eq_catheter','Equipment: Catheter')+chk('m_eq_peg','Equipment: PEG')+chk('m_eq_oxy','Equipment: Oxygen')+chk('m_eq_mob','Equipment: Mobility Aids')+chk('m_eq_other','Equipment: Other');
  line('Equipment Other', v('m_eq_other_txt'));
  r+=chk('m_eap_yes','Emergency Plan: Yes')+chk('m_eap_no','Emergency Plan: No'); line('EAP Details', v('m_eap'));
  line('Ack Name', v('m_ack_name')); line('Relationship', v('m_ack_rel')); line('Signature', v('m_ack_sig')); line('Date', v('m_ack_date'));
  line('Rep Name', v('m_rep_name')); line('Rep Position', v('m_rep_pos')); line('Rep Date', v('m_rep_date'));

  // RISK
  h1('RISK ASSESSMENT');
  r+=chk('k_trip','Trip hazards')+chk('k_access','Limited access')+chk('k_fire','Fire hazards')+chk('k_storage','Unsafe storage')+chk('k_pets','Pets risk')+chk('k_other','Other');
  line('Home Comments', v('k_home_comments'));
  r+=chk('k_sz','Seizures')+chk('k_dm','Diabetes')+chk('k_pressure','Pressure injury')+chk('k_choke','Choking risk')+chk('k_medside','Med side effects/non-compliance')+chk('k_allergy','Allergies/anaphylaxis')+chk('k_complex','Complex procedures')+chk('k_other_h','Other');
  line('Health Comments', v('k_health_comments'));
  r+=chk('k_aggr','Aggression/self-harm')+chk('k_engage','Difficulty engaging')+chk('k_abscond','Absconding')+chk('k_resist','Resistance to care')+chk('k_rp','Restrictive practices used')+chk('k_other_b','Other');
  line('Behaviour Comments', v('k_beh_comments'));
  r+=chk('k_falls','Falls risk')+chk('k_hoist','Hoist/manual handling')+chk('k_aids','Needs mobility aids')+chk('k_gait','Uneven gait')+chk('k_other_m','Other');
  line('Mobility Comments', v('k_mob_comments'));
  r+=chk('k_pt','Public transport difficulty')+chk('k_travel','Requires travel support')+chk('k_disor','Disorientation in public')+chk('k_other_t','Other');
  line('Transport Comments', v('k_trans_comments'));
  r+=chk('k_understand','Understands procedures')+chk('k_contact','Emergency contact available')+chk('k_norespond','May not respond to alarms')+chk('k_evac','Requires evacuation support')+chk('k_other_e','Other');
  line('Emergency Comments', v('k_emerg_comments'));
  line('Overall Risk', v('k_overall')); r+=chk('k_fu_plan','Follow-up: Risk Plan')+chk('k_fu_notify','Follow-up: Notify RN/TL')+chk('k_fu_reassess','Follow-up: Reassess')+chk('k_fu_other','Follow-up: Other');
  line('Signature', v('k_sig')); line('Sig Date', v('k_sig_date')); line('HD Rep', v('k_rep')); line('Rep Date', v('k_rep_date'));

  r+='}';
  const blob=new Blob([r],{type:'application/rtf'});
  const a=document.createElement('a'); a.href=URL.createObjectURL(blob);
  const fname=(v('o_name')||v('r_name')||'Client').replace(/[^A-Za-z0-9 _-]/g,'').replace(/\s+/g,'_') + '_HD_Master_v4.rtf';
  a.download=fname; a.click(); URL.revokeObjectURL(a.href);
});
</script>
</body>
</html>
"""
out = Path("/mnt/data/HD_HeeD_Client_Master_Suite_v4.html")
out.write_text(html, encoding="utf-8")
out.as_posix()
